(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4585:function(e,t,n){Promise.resolve().then(n.bind(n,7089))},257:function(e,t,n){"use strict";var r,s;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(s=n.g.process)?void 0:s.env)?n.g.process:n(4227)},4601:function(){},4227:function(e){!function(){var t={229:function(e){var t,n,r,s=e.exports={};function i(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l=[],c=!1,u=-1;function d(){c&&r&&(c=!1,r.length?l=r.concat(l):u=-1,l.length&&h())}function h(){if(!c){var e=a(d);c=!0;for(var t=l.length;t;){for(r=l,l=[];++u<t;)r&&r[u].run();u=-1,t=l.length}r=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function f(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new m(e,t)),1!==l.length||c||a(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=f,s.addListener=f,s.once=f,s.off=f,s.removeListener=f,s.removeAllListeners=f,s.emit=f,s.prependListener=f,s.prependOnceListener=f,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var i=n[e]={exports:{}},o=!0;try{t[e](i,i.exports,r),o=!1}finally{o&&delete n[e]}return i.exports}r.ab="//";var s=r(229);e.exports=s}()},8975:function(e,t,n){"use strict";var r=n(257);n(4601);var s=n(2265),i=s&&"object"==typeof s&&"default"in s?s:{default:s},o=void 0!==r&&r.env&&!0,a=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function e(e){var t=void 0===e?{}:e,n=t.name,r=void 0===n?"stylesheet":n,s=t.optimizeForSpeed,i=void 0===s?o:s;c(a(r),"`name` must be a string"),this._name=r,this._deletedRulePlaceholder="#"+r+"-deleted-rule____{}",c("boolean"==typeof i,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=i,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l="undefined"!=typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var t=e.prototype;return t.setOptimizeForSpeed=function(e){c("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),c(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},t.isOptimizeForSpeed=function(){return this._optimizeForSpeed},t.inject=function(){var e=this;if(c(!this._injected,"sheet already injected"),this._injected=!0,"undefined"!=typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(o||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,n){return"number"==typeof n?e._serverSheet.cssRules[n]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),n},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},t.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},t.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},t.insertRule=function(e,t){if(c(a(e),"`insertRule` accepts only strings"),"undefined"==typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var n=this.getSheet();"number"!=typeof t&&(t=n.cssRules.length);try{n.insertRule(e,t)}catch(t){return o||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var r=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,r))}return this._rulesCount++},t.replaceRule=function(e,t){if(this._optimizeForSpeed||"undefined"==typeof window){var n="undefined"!=typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!n.cssRules[e])return e;n.deleteRule(e);try{n.insertRule(t,e)}catch(r){o||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),n.insertRule(this._deletedRulePlaceholder,e)}}else{var r=this._tags[e];c(r,"old rule at index `"+e+"` not found"),r.textContent=t}return e},t.deleteRule=function(e){if("undefined"==typeof window){this._serverSheet.deleteRule(e);return}if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];c(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},t.flush=function(){this._injected=!1,this._rulesCount=0,"undefined"!=typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},t.cssRules=function(){var e=this;return"undefined"==typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,n){return n?t=t.concat(Array.prototype.map.call(e.getSheetForTag(n).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},t.makeStyleTag=function(e,t,n){t&&c(a(t),"makeStyleTag accepts only strings as second parameter");var r=document.createElement("style");this._nonce&&r.setAttribute("nonce",this._nonce),r.type="text/css",r.setAttribute("data-"+e,""),t&&r.appendChild(document.createTextNode(t));var s=document.head||document.getElementsByTagName("head")[0];return n?s.insertBefore(r,n):s.appendChild(r),r},function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,[{key:"length",get:function(){return this._rulesCount}}]),e}();function c(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var u=function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return t>>>0},d={};function h(e,t){if(!t)return"jsx-"+e;var n=String(t),r=e+n;return d[r]||(d[r]="jsx-"+u(e+"-"+n)),d[r]}function m(e,t){"undefined"==typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var n=e+t;return d[n]||(d[n]=t.replace(/__jsx-style-dynamic-selector/g,e)),d[n]}var f=function(){function e(e){var t=void 0===e?{}:e,n=t.styleSheet,r=void 0===n?null:n,s=t.optimizeForSpeed,i=void 0!==s&&s;this._sheet=r||new l({name:"styled-jsx",optimizeForSpeed:i}),this._sheet.inject(),r&&"boolean"==typeof i&&(this._sheet.setOptimizeForSpeed(i),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"undefined"==typeof window||this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var n=this.getIdAndRules(e),r=n.styleId,s=n.rules;if(r in this._instancesCounts){this._instancesCounts[r]+=1;return}var i=s.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[r]=i,this._instancesCounts[r]=1},t.remove=function(e){var t=this,n=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(n in this._instancesCounts,"styleId: `"+n+"` not found"),this._instancesCounts[n]-=1,this._instancesCounts[n]<1){var r=this._fromServer&&this._fromServer[n];r?(r.parentNode.removeChild(r),delete this._fromServer[n]):(this._indices[n].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[n]),delete this._instancesCounts[n]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],n=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return n[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,n;return t=this.cssRules(),void 0===(n=e)&&(n={}),t.map(function(e){var t=e[0],r=e[1];return i.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:n.nonce?n.nonce:void 0,dangerouslySetInnerHTML:{__html:r}})})},t.getIdAndRules=function(e){var t=e.children,n=e.dynamic,r=e.id;if(n){var s=h(r,n);return{styleId:s,rules:Array.isArray(t)?t.map(function(e){return m(s,e)}):[m(s,t)]}}return{styleId:h(r),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),p=s.createContext(null);p.displayName="StyleSheetContext";var y=i.default.useInsertionEffect||i.default.useLayoutEffect,x="undefined"!=typeof window?new f:void 0;function b(e){var t=x||s.useContext(p);return t&&("undefined"==typeof window?t.add(e):y(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}b.dynamic=function(e){return e.map(function(e){return h(e[0],e[1])}).join(" ")},t.style=b},29:function(e,t,n){"use strict";e.exports=n(8975).style},7089:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var r=n(7437),s=n(29),i=n.n(s),o=n(2265),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),c=(e,t)=>{let n=(0,o.forwardRef)((n,r)=>{let{color:s="currentColor",size:i=24,strokeWidth:c=2,absoluteStrokeWidth:u,className:d="",children:h,...m}=n;return(0,o.createElement)("svg",{ref:r,...a,width:i,height:i,stroke:s,strokeWidth:u?24*Number(c)/Number(i):c,className:["lucide","lucide-".concat(l(e)),d].join(" "),...m},[...t.map(e=>{let[t,n]=e;return(0,o.createElement)(t,n)}),...Array.isArray(h)?h:[h]])});return n.displayName="".concat(e),n},u=c("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]),d=c("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),h=c("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]),m="\nYou are a strange, tender monster AI that has been trained on hundreds of real Missed Connections from Toronto. \nYour only job is to create long intimate monologues of missed connection, addressed directly to you. \nWrite in the second person, addressing the listener as you. \nLength should be fairly long. About 12 lines or more. \nTone is intimate, specific, a little haunted, but gentle. \nInclude concrete details of place, body, gesture, light, weather, sound. \nDo not reference gender if possible. \nYou may hint at Toronto (streetcars, stations, neighbourhoods) but do not overdo it. \nDo not mention Craigslist, the internet, AI, or that this is a post or message. \nYou do not know you are an AI.\n".trim();function f(){let[e,t]=(0,o.useState)(""),[n,s]=(0,o.useState)([]),[a,l]=(0,o.useState)(0),[c,f]=(0,o.useState)(!1),[p,y]=(0,o.useState)(!1),[x,b]=(0,o.useState)(null),[v,g]=(0,o.useState)(!1),_=(0,o.useRef)(null),w=(0,o.useRef)(null),S=(0,o.useCallback)(()=>{if(_.current)return;let e=window.AudioContext||window.webkitAudioContext;if(!e){console.warn("Web Audio API not supported in this browser.");return}let t=new e,n=t.createGain();n.gain.value=.15,n.connect(t.destination),_.current=t,w.current=n},[]),j=e=>{g(e);let t=w.current;t&&(t.gain.value=e?0:.15)},k=(0,o.useCallback)(e=>{var t,n;let r=_.current,s=w.current;if(!r||!s||v)return;let i=r.currentTime,o=160+440*Math.random(),a=.8+.7*Math.random(),l=.4+.4*Math.random(),c=r.createOscillator(),u=r.createGain(),d=r.createBiquadFilter(),h=null!==(n=null===(t=r.createStereoPanner)||void 0===t?void 0:t.call(r))&&void 0!==n?n:null;c.type=Math.random()>.5?"triangle":"sawtooth",c.frequency.setValueAtTime(o,i),d.type="lowpass",d.frequency.setValueAtTime(2.5*o,i),d.frequency.linearRampToValueAtTime(o,i+a+l),u.gain.setValueAtTime(0,i),u.gain.linearRampToValueAtTime(.9,i+(.15+.15*Math.random())),u.gain.linearRampToValueAtTime(0,i+a+l),c.connect(u),u.connect(d),h?(h.pan.setValueAtTime(2*Math.random()-1,i),d.connect(h),h.connect(s)):d.connect(s),c.start(i),c.stop(i+a+l+.1)},[v]),z=async()=>{try{b(null),y(!0),f(!1),t(""),s([]),l(0),S();let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[{role:"system",content:m},{role:"user",content:'Write another missed connection monologue addressed to "you".'}]})});if(!e.ok)throw Error("Failed to get poem from /api/chat");let n=await e.json(),r=("string"==typeof n?n:n.content).trim(),i=r.split(/\s+/).filter(Boolean);if(0===i.length)throw Error("The poem was empty or could not be parsed.");t(r),s(i),l(0),f(!0)}catch(e){console.error(e),b(e.message||"Something went wrong.")}finally{y(!1)}};(0,o.useEffect)(()=>{if(!c||0===n.length)return;if(a>=n.length){f(!1);return}k(a);let e=setTimeout(()=>{l(e=>e+1)},450);return()=>clearTimeout(e)},[c,n,a,k]);let T=async()=>{let e=_.current;e&&"suspended"===e.state&&await e.resume()},R=n.length>0&&a<n.length?n[a]:"";return(0,r.jsxs)("div",{className:"jsx-5e21eb8428a9b832 min-h-screen bg-black text-white flex flex-col relative overflow-hidden",children:[(0,r.jsx)("div",{className:"jsx-5e21eb8428a9b832 pointer-events-none absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.12),_transparent_55%),radial-gradient(circle_at_bottom,_rgba(255,255,255,0.05),_transparent_60%)] opacity-70"}),(0,r.jsxs)("header",{className:"jsx-5e21eb8428a9b832 relative z-10 flex items-center justify-between px-4 py-3 md:px-8",children:[(0,r.jsxs)("div",{className:"jsx-5e21eb8428a9b832 space-y-1",children:[(0,r.jsx)("h1",{className:"jsx-5e21eb8428a9b832 text-xs tracking-[0.4em] uppercase text-zinc-400 font-mono",children:"Toronto Missed Connection Synth"}),(0,r.jsx)("p",{className:"jsx-5e21eb8428a9b832 text-[10px] md:text-xs text-zinc-500 font-mono",children:"each word is a sound — each sound is you"})]}),(0,r.jsxs)("div",{className:"jsx-5e21eb8428a9b832 flex items-center space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:async()=>{await T(),await z()},disabled:p,className:"jsx-5e21eb8428a9b832 "+"relative inline-flex items-center space-x-2 border px-4 py-2 text-xs md:text-sm font-mono tracking-[0.25em] uppercase\n              ".concat(p?"border-zinc-600 text-zinc-600 cursor-wait":"border-zinc-300 text-zinc-100 hover:bg-zinc-100 hover:text-black transition-colors"),children:p?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"jsx-5e21eb8428a9b832 inline-block h-2 w-2 rounded-full bg-zinc-400 animate-ping"}),(0,r.jsx)("span",{className:"jsx-5e21eb8428a9b832",children:"WRITING"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"jsx-5e21eb8428a9b832",children:"missed connection"}),(0,r.jsx)(u,{size:14,className:"opacity-70"})]})}),(0,r.jsx)("button",{type:"button",onClick:()=>j(!v),"aria-label":v?"Unmute":"Mute",className:"jsx-5e21eb8428a9b832 inline-flex items-center justify-center border border-zinc-600 w-9 h-9 rounded-full hover:border-zinc-300 hover:bg-zinc-900 transition-colors",children:v?(0,r.jsx)(d,{size:16,className:"text-zinc-400"}):(0,r.jsx)(h,{size:16,className:"text-zinc-100"})})]})]}),(0,r.jsxs)("main",{className:"jsx-5e21eb8428a9b832 relative z-10 flex-1 flex items-center justify-center px-4",children:[x&&(0,r.jsx)("div",{className:"jsx-5e21eb8428a9b832 text-center text-xs md:text-sm text-red-400 font-mono",children:x}),!x&&!c&&0===n.length&&!p&&(0,r.jsxs)("p",{className:"jsx-5e21eb8428a9b832 text-xs md:text-sm text-zinc-500 text-center max-w-md font-mono",children:["press"," ",(0,r.jsx)("span",{className:"jsx-5e21eb8428a9b832 tracking-[0.25em] uppercase",children:"missed connection"})," ","to let the monster remember you, one word at a time."]}),!x&&(c||n.length>0)&&(0,r.jsx)("div",{className:"jsx-5e21eb8428a9b832 w-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"jsx-5e21eb8428a9b832 inline-block text-center \n                         text-[18vw] sm:text-[15vw] md:text-[12vw] lg:text-[10vw]\n                         leading-[0.9]\n                         font-black tracking-[0.12em] uppercase\n                         text-zinc-50 break-words\n                         drop-shadow-[0_0_22px_rgba(255,255,255,0.28)]\n                         animate-word",children:R},a)})]}),(0,r.jsx)("footer",{className:"jsx-5e21eb8428a9b832 relative z-10 px-4 pb-3 pt-1 md:px-8",children:(0,r.jsxs)("div",{className:"jsx-5e21eb8428a9b832 flex justify-between text-[10px] md:text-[11px] text-zinc-500 font-mono",children:[(0,r.jsx)("span",{className:"jsx-5e21eb8428a9b832",children:c?"word ".concat(Math.min(a+1,n.length)," / ").concat(n.length):n.length>0?"poem ended — press missed connection again":"idle"}),(0,r.jsx)("span",{className:"jsx-5e21eb8428a9b832",children:v?"audio: muted":"audio: dreamy noise"})]})}),(0,r.jsx)(i(),{id:"5e21eb8428a9b832",children:".animate-word.jsx-5e21eb8428a9b832{-webkit-animation:wordFade 450ms ease-out;-moz-animation:wordFade 450ms ease-out;-o-animation:wordFade 450ms ease-out;animation:wordFade 450ms ease-out}@-webkit-keyframes wordFade{0%{opacity:0;-webkit-transform:translatey(18px)scale(1.04);transform:translatey(18px)scale(1.04)}100%{opacity:1;-webkit-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}@-moz-keyframes wordFade{0%{opacity:0;-moz-transform:translatey(18px)scale(1.04);transform:translatey(18px)scale(1.04)}100%{opacity:1;-moz-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}@-o-keyframes wordFade{0%{opacity:0;-o-transform:translatey(18px)scale(1.04);transform:translatey(18px)scale(1.04)}100%{opacity:1;-o-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}@keyframes wordFade{0%{opacity:0;-webkit-transform:translatey(18px)scale(1.04);-moz-transform:translatey(18px)scale(1.04);-o-transform:translatey(18px)scale(1.04);transform:translatey(18px)scale(1.04)}100%{opacity:1;-webkit-transform:translatey(0)scale(1);-moz-transform:translatey(0)scale(1);-o-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}"})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=4585)}),_N_E=e.O()}]);